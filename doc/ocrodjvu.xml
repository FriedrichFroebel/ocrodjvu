<?xml version='1.0' encoding='utf-8'?>
<!DOCTYPE refentry PUBLIC '-//OASIS//DTD DocBook XML V4.5//EN' 'http://www.docbook.org/xml/4.5/docbookx.dtd'
[
    <!ENTITY p 'ocrodjvu'>
    <!ENTITY version '0.4.7'>
]>

<refentry>

<refentryinfo>
    <title>&p; manual</title>
    <productname>&p;</productname>
    <author>
        <firstname>Jakub</firstname> <surname>Wilk</surname>
        <affiliation>
            <address>
                <email>jwilk@jwilk.net</email>
            </address>
        </affiliation>
    </author>
    <copyright>
        <year>2008</year>
        <year>2009</year>
        <year>2010</year>
        <holder>Jakub Wilk</holder>
    </copyright>
</refentryinfo>

<refmeta>
    <refentrytitle>&p;</refentrytitle>
    <manvolnum>1</manvolnum>
    <refmiscinfo class='version'>&version;</refmiscinfo>
</refmeta>

<refnamediv>
    <refname>&p;</refname>
    <refpurpose>OCR for DjVu files</refpurpose>
</refnamediv>

<refsynopsisdiv>
    <cmdsynopsis>
        <command>&p;</command>
        <group choice='req'>
            <arg choice='plain'><option>-o</option></arg>
            <arg choice='plain'><option>--save-bundled</option></arg>
        </group>
        <arg choice='plain'><replaceable>output-djvu-file</replaceable></arg>
        <arg choice='opt' rep='repeat'><replaceable>option</replaceable></arg>
        <arg choice='plain'><replaceable>djvu-file</replaceable></arg>
    </cmdsynopsis>
    <cmdsynopsis>
        <command>&p;</command>
        <group choice='req'>
            <arg choice='plain'><option>-i</option></arg>
            <arg choice='plain'><option>--save-indirect</option></arg>
        </group>
        <arg choice='plain'><replaceable>index-djvu-file</replaceable></arg>
        <arg choice='opt' rep='repeat'><replaceable>option</replaceable></arg>
        <arg choice='plain'><replaceable>djvu-file</replaceable></arg>
    </cmdsynopsis>
    <cmdsynopsis>
        <command>&p;</command>
        <arg choice='plain'><option>--save-script</option></arg>
        <arg choice='plain'><replaceable>script-file</replaceable></arg>
        <arg choice='opt' rep='repeat'><replaceable>option</replaceable></arg>
        <arg choice='plain'><replaceable>djvu-file</replaceable></arg>
    </cmdsynopsis>
    <cmdsynopsis>
        <command>&p;</command>
        <arg choice='plain'><option>--in-place</option></arg>
        <arg choice='opt' rep='repeat'><replaceable>option</replaceable></arg>
        <arg choice='plain'><replaceable>djvu-file</replaceable></arg>
    </cmdsynopsis>
    <cmdsynopsis>
        <command>&p;</command>
        <arg choice='plain'><option>--dry-run</option></arg>
        <arg choice='opt' rep='repeat'><replaceable>option</replaceable></arg>
        <arg choice='plain'><replaceable>djvu-file</replaceable></arg>
    </cmdsynopsis>
    <cmdsynopsis>
        <command>&p;</command>
        <group choice='req'>
            <arg choice='plain'><option>--version</option></arg>
            <arg choice='plain'><option>--help</option></arg>
            <arg choice='plain'><option>-h</option></arg>
            <arg choice='plain'><option>--list-engines</option></arg>
            <arg choice='plain'><option>--list-languages</option></arg>
        </group>
    </cmdsynopsis>
</refsynopsisdiv>

<refsection>
    <title>Description</title>
    <para>
        &p; is a wrapper for OCR systems that allows you to perform OCR on DjVu files.
    </para>
    <para>
        The following OCR engines are supported:
        <itemizedlist>
        <listitem>
            <para><ulink url='http://ocropus.googlecode.com/'><application>OCRopus</application></ulink> (internally,
                &p; calls <command>ocroscript</command>'s <command>recognize</command> (or <command>rec-tess</command>)
                command, so that ultimately <application>Tesseract</application> acts as the OCR backend);
            </para>
        </listitem>
        <listitem>
            <para><ulink url='http://launchpad.net/cuneiform-linux'><application>Cuneiform for Linux</application></ulink>.</para>
        </listitem>
        </itemizedlist>
    </para>
</refsection>

<refsection>
    <title>Options</title>
    <refsection>
        <title>OCR engine options</title>
        <variablelist>
        <varlistentry>
            <term><option>--engine=<replaceable>engine-id</replaceable></option></term>
            <listitem>
                <para>
                    Use this OCR engine. The default is ‘<literal>ocropus</literal>’ (OCRopus).
                </para>
            </listitem>
        </varlistentry>
        <varlistentry>
            <term><option>--list-engines</option></term>
            <listitem>
                <para>
                    Print list of available OCR engines.
                </para>
            </listitem>
        </varlistentry>
        </variablelist>
    </refsection>
    <refsection>
        <title>Options controlling output</title>
        <para>
            It is mandatory to use exactly one of the following options:
        </para>
        <variablelist>
        <varlistentry>
            <term><option>-o</option></term>
            <term><option>--save-bundled=<filename><replaceable>output-djvu-file</replaceable></filename></option></term>
            <listitem>
                <para>
                    Save OCR results as a bundled multi-page document into
                    <filename><replaceable>output-djvu-file</replaceable></filename>.
                </para>
            </listitem>
        </varlistentry>
        <varlistentry>
            <term><option>-i</option></term>
            <term><option>--save-indirect=<filename><replaceable>index-djvu-file</replaceable></filename></option></term>
            <listitem>
                <para>
                    Save OCR results as an indirect multi-page document. Use
                    <filename><replaceable>index-djvu-file</replaceable></filename> as the index file name; put the
                    component files into the same directory. The directory must exist and be writable.
                </para>
            </listitem>
        </varlistentry>
        <varlistentry>
            <term><option>--save-script=<filename><replaceable>script-file</replaceable></filename></option></term>
            <listitem>
                <para>
                    Save a <command>djvused</command> script with OCR results into
                    <replaceable>script-file</replaceable>.
                </para>
            </listitem>
        </varlistentry>
        <varlistentry>
            <term><option>--in-place</option></term>
            <listitem>
                <para>
                    Save OCR results in place.
                </para>
                <para>
                    (Use this option to retain compatibility with &p; &lt; 0.2.)
                </para>
            </listitem>
        </varlistentry>
        <varlistentry>
            <term><option>--dry-run</option></term>
            <listitem>
                <para>
                    Don't change any files, throw OCR results away.
                </para>
            </listitem>
        </varlistentry>
        </variablelist>
    </refsection>
    <refsection>
        <title>Text segmentation options</title>
        <variablelist>
        <varlistentry>
            <term><option>-t lines</option></term>
            <term><option>--details lines</option></term>
            <listitem>
                <para>
                    Record location of every line. Don't record locations of particular words or characters.
                </para>
                <para>
                    This is the default for OCRopus 0.2.
                </para>
            </listitem>
        </varlistentry>
        <varlistentry>
            <term><option>-t words</option></term>
            <term><option>--details=words</option></term>
            <listitem>
                <para>
                    Record location of every line and every word. Don't record locations of particular characters.
                </para>
                <para>
                    This is the default for OCRopus ≥ 0.3.1 and for Cuneiform.
                </para>
                <para>
                    This option is ineffective with OCRopus 0.2.
                </para>
            </listitem>
        </varlistentry>
        <varlistentry>
            <term><option>-t chars</option></term>
            <term><option>--details=chars</option></term>
            <listitem>
                <para>
                    Record location of every line, every word and every character.
                </para>
                <para>
                    This option is ineffective with OCRopus 0.2.
                </para>
            </listitem>
        </varlistentry>
        <varlistentry>
            <term><option>--word-segmentation=simple</option></term>
            <listitem>
                <para>
                    Consider each non-empty sequence of non-whitespace characters a single word.
                </para>
                <para>
                    This is the default, despite being linguistically incorrect.
                </para>
            </listitem>
        </varlistentry>
        <varlistentry>
            <term><option>--word-segmentation=uax29</option></term>
            <listitem>
                <para>
                    Use the <ulink url='http://unicode.org/reports/tr29/'>Unicode Text Segmentation</ulink> algorithm
                    to break lines into words.
                </para>
                <para>
                    This option breaks assumptions of some DjVu tools that words are separated by spaces,
                    and therefore is it not recommended.
                </para>
            </listitem>
        </varlistentry>
        </variablelist>
    </refsection>
    <refsection>
        <title>Other options</title>
        <variablelist>
        <varlistentry>
            <term><option>--clear-text</option></term>
            <listitem>
                <para>
                    Remove existing hidden text if present in the pages not selected for OCR.
                </para>
                <para>
                    (Use this option to retain compatibility with &p; &lt; 0.2.)
                </para>
            </listitem>
        </varlistentry>
        <varlistentry>
            <term><option>--ocr-only</option></term>
            <listitem>
                <para>Don't save pages that were not processed.</para>
            </listitem>
        </varlistentry>
        <varlistentry>
            <term><option>--language=<replaceable>language-id</replaceable></option></term>
            <listitem>
                <para>
                    Set recognition language. <replaceable>language-id</replaceable> is typically an ISO 639-2
                    three-letter code.
                </para>
                <para>
                    For OCRopus, the default is ‘<literal>eng</literal>’ (English), unless the
                    <varname>tesslanguage</varname> environment variable is set.
                    For other OCR engines, the default is always ‘<literal>eng</literal>’.
                </para>
            </listitem>
        </varlistentry>
        <varlistentry>
            <term><option>--list-languages</option></term>
            <listitem>
                <para>
                    Print list of available languages for the currently selected OCR engine.
                </para>
            </listitem>
        </varlistentry>
        <varlistentry>
            <term><option>--render=mask</option></term>
            <listitem>
                <para>
                    Render only masks of page images.
                </para>
                <para>
                    This is the default.
                </para>
            </listitem>
        </varlistentry>
        <varlistentry>
            <term><option>--render=foreground</option></term>
            <listitem>
                <para>
                    Render only foreground layers of page images.
                </para>
            </listitem>
        </varlistentry>
        <varlistentry>
            <term><option>--render=all</option></term>
            <listitem>
                <para>
                    Render all layers of page images.
                </para>
                <para>
                    This option is necessary to OCR DjVu files with invalid foreground/background separation.
                </para>
            </listitem>
        </varlistentry>
        <varlistentry>
            <term><option>-p</option></term>
            <term><option>--pages=<replaceable>page-range</replaceable></option></term>
            <listitem>
                <para>
                    Specifies pages to process. <replaceable>page-range</replaceable> is a comma-separated list of
                    sub-ranges. Each sub-range is either a single page (e.g. <literal>17</literal>) or a contiguous
                    range of pages (e.g. <literal>37-42</literal>). Pages are numbered from 1.
                </para>
                <para>
                    The default is to process all pages.
                </para>
            </listitem>
        </varlistentry>
        <varlistentry>
            <term><option>-j</option></term>
            <term><option>--jobs=<replaceable>n</replaceable></option></term>
            <listitem>
                <para>
                    Start up to <replaceable>n</replaceable> OCR processes.
                </para>
            </listitem>
        </varlistentry>
        <varlistentry>
            <term><option>-D</option></term>
            <term><option>--debug</option></term>
            <listitem>
                <para>To ease debugging, don't delete intermediate files.</para>
            </listitem>
        </varlistentry>
        <varlistentry>
            <term><option>--version</option></term>
            <listitem>
                <para>Output version information and exit.</para>
            </listitem>
        </varlistentry>
        <varlistentry>
            <term><option>-h</option></term>
            <term><option>--help</option></term>
            <listitem>
                <para>Display help and exit.</para>
            </listitem>
        </varlistentry>
        </variablelist>
    </refsection>
</refsection>

<refsection>
    <title>Environment</title>
    <para>
        The following environment variables affects <command>&p;</command>:
        <variablelist>
        <varlistentry>
            <term><varname>tesslanguage</varname></term>
            <listitem>
                <para>
                    Recognition language for Tesseract.
                </para>
                <para>
                    (Use this variable is deprecated in favor of the <option>--language</option> option.)
                </para>
            </listitem>
        </varlistentry>
        <varlistentry>
            <term><varname>TMPDIR</varname></term>
            <!-- As per IEEE Std 1003.1, 2004 Edition, “8.3 Other Environment Variables”:
            http://www.opengroup.org/onlinepubs/009695399/basedefs/xbd_chap08.html#tag_08_03
            -->
            <listitem>
                <para>
                    Directory for temporary files. The default is <filename>/tmp</filename>.
                </para>
            </listitem>
        </varlistentry>
        </variablelist>
    </para>
</refsection>

<refsection>
    <title>See also</title>
    <para>
        <citerefentry>
            <refentrytitle>djvu</refentrytitle>
            <manvolnum>1</manvolnum>
        </citerefentry>,
        <citerefentry>
            <refentrytitle>ocroscript</refentrytitle>
            <manvolnum>1</manvolnum>
        </citerefentry>,
        <citerefentry>
            <refentrytitle>tesseract</refentrytitle>
            <manvolnum>1</manvolnum>
        </citerefentry>
    </para>
</refsection>

</refentry>

<!-- vim:set ts=4 sw=4 tw=120 et: -->
